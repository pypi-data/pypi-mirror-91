/// Files: drivers/accessibility/speakup/spk_ttyio.c drivers/staging/speakup/spk_ttyio.c
/// Fix: d4122754442799187d5d537a9c039a49a67e57f1

virtual detect

@err@
identifier tty;
position p;
@@

spk_ttyio_ldisc_open(struct tty_struct *tty)
{
	... when != mutex_lock(...);
	speakup_tty = tty;@p
	... when != mutex_unlock(...);
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-28941")
