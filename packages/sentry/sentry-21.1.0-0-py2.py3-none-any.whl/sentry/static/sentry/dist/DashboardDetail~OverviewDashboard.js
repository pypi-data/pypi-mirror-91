(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[17],{1887:function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return c})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return u})),r.d(t,"a",(function(){return d})),r.d(t,"c",(function(){return l}));var n=r(3),a=r(7),o=Object(n.a)("div",{target:"e1w1bh460",label:"GridCell"})({name:"1kuy7z7",styles:"font-size:14px;"}),i=Object(n.a)(o,{target:"e1w1bh461",label:"GridCellNumber"})({name:"s2uf1z",styles:"text-align:right;"}),c=Object(n.a)("div",{target:"e1w1bh462",label:"DoubleHeaderContainer"})("display:grid;grid-template-columns:1fr 1fr;padding:",Object(a.a)(2)," ",Object(a.a)(3)," ",Object(a.a)(1)," ",Object(a.a)(3),";grid-gap:",Object(a.a)(3),";"),s=Object(n.a)("div",{target:"e1w1bh463",label:"HeaderTitle"})("display:inline-grid;grid-auto-flow:column;grid-gap:",Object(a.a)(1),";font-size:",(function(e){return e.theme.fontSizeLarge}),";color:",(function(e){return e.theme.textColor}),";align-items:center;"),u=Object(n.a)(s,{target:"e1w1bh464",label:"HeaderTitleLegend"})("background-color:",(function(e){return e.theme.background}),";border-radius:",(function(e){return e.theme.borderRadius}),";position:absolute;z-index:1;"),d=Object(n.a)("div",{target:"e1w1bh465",label:"ChartContainer"})("padding:",Object(a.a)(2)," ",Object(a.a)(3),";"),l=Object(n.a)("div",{target:"e1w1bh466",label:"ErrorPanel"})({name:"195kgij",styles:"display:flex;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:200px;position:relative;border-color:transparent;margin-bottom:0;"})},1890:function(e,t,r){"use strict";r(1);var n=r(259),a=r.n(n),o=r(0),i=function(e){var t="".concat(e.title," - ").concat(e.objSlug," - Sentry");return Object(o.f)(a.a,{title:t},e.children)};i.displayName="SentryDocumentTitle",t.a=i},2051:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){var t={userSelect:document.body.style.userSelect,MozUserSelect:document.body.style.MozUserSelect,msUserSelect:document.body.style.msUserSelect,webkitUserSelect:document.body.style.webkitUserSelect};return document.body.style.userSelect=e.userSelect||"",document.body.style.MozUserSelect=e.MozUserSelect||"",document.body.style.msUserSelect=e.msUserSelect||"",document.body.style.webkitUserSelect=e.webkitUserSelect||"",t}},2196:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return c})),r.d(t,"d",(function(){return s}));var n=r(34),a=r(4);function o(e,t,r){var o=r.title,i=r.widgets,c=e.requestPromise("/organizations/".concat(t,"/dashboards/"),{method:"POST",data:{title:o,widgets:i}});return c.catch((function(e){var t,r=null!==(t=null==e?void 0:e.responseJSON)&&void 0!==t?t:null;r?Object(n.a)(r):Object(n.a)(Object(a.b)("Unable to create dashboard"))})),c}function i(e,t,r){var o={title:r.title,widgets:r.widgets},i=e.requestPromise("/organizations/".concat(t,"/dashboards/").concat(r.id,"/"),{method:"PUT",data:o});return i.catch((function(e){var t,r=null!==(t=null==e?void 0:e.responseJSON)&&void 0!==t?t:null;r?Object(n.a)(r):Object(n.a)(Object(a.b)("Unable to update dashboard"))})),i}function c(e,t,r){var o=e.requestPromise("/organizations/".concat(t,"/dashboards/").concat(r,"/"),{method:"DELETE"});return o.catch((function(e){var t,r=null!==(t=null==e?void 0:e.responseJSON)&&void 0!==t?t:null;r?Object(n.a)(r):Object(n.a)(Object(a.b)("Unable to delete dashboard"))})),o}function s(e,t,r){return e.requestPromise("/organizations/".concat(t,"/dashboards/widgets/"),{method:"POST",data:r})}},2197:function(e,t,r){"use strict";function n(e,t){var r="nativeEvent"in e?e.nativeEvent:e;return window.TouchEvent&&r instanceof TouchEvent?r.targetTouches[0][t]:r instanceof MouseEvent?r[t]:0}r.d(t,"a",(function(){return n}))},2204:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o}));var n=r(4),a={id:"",dateCreated:"",createdBy:"",title:Object(n.b)("Untitled dashboard"),widgets:[]},o=[{label:Object(n.b)("Area chart"),value:"area"},{label:Object(n.b)("Bar chart"),value:"bar"},{label:Object(n.b)("Line chart"),value:"line"}];Object(n.b)("1 Minute"),Object(n.b)("5 Minutes"),Object(n.b)("15 Minutes"),Object(n.b)("30 Minutes"),Object(n.b)("1 Hour"),Object(n.b)("1 Day")},2205:function(e,t,r){"use strict";var n=r(6),a=r.n(n),o=r(9),i=r.n(o),c=r(10),s=r.n(c),u=r(11),d=r.n(u),l=r(13),f=r.n(l),p=r(5),b=r.n(p),g=r(3),h=r(1),v=r.n(h),y=r(16),O=r(7),m=r(52),j=r(0);function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var D=function(e){d()(r,e);var t=w(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={isFocused:!1,isHovering:!1},e.refInput=v.a.createRef(),e.blur=function(){e.refInput.current&&e.refInput.current.blur()},e.focus=function(){e.refInput.current&&e.refInput.current.focus()},e.onBlur=function(t){e.setState({isFocused:!1,isHovering:!1}),Object(m.a)(e.props.onBlur,r.setValueOnEvent(t))},e.onFocus=function(t){e.setState({isFocused:!0}),Object(m.a)(e.props.onFocus,r.setValueOnEvent(t))},e.onChangeUsingOnInput=function(t){Object(m.a)(e.props.onChange,r.setValueOnEvent(t))},e.onKeyDown=function(t){"Enter"===t.key&&(t.preventDefault(),e.refInput.current&&e.refInput.current.blur()),Object(m.a)(e.props.onKeyUp,r.setValueOnEvent(t))},e.onKeyUp=function(t){"Escape"===t.key&&e.refInput.current&&e.refInput.current.blur(),Object(m.a)(e.props.onKeyUp,r.setValueOnEvent(t))},e.onMouseEnter=function(){e.setState({isHovering:!e.props.disabled})},e.onMouseMove=function(){e.setState({isHovering:!e.props.disabled})},e.onMouseLeave=function(){e.setState({isHovering:!1})},e.onClickIcon=function(t){e.props.disabled||(e.refInput.current&&e.refInput.current.focus(),Object(m.a)(e.props.onClick,r.setValueOnEvent(t)))},e}return s()(r,[{key:"render",value:function(){var e=this.props,t=e.value,r=e.placeholder,n=e.disabled,o=this.state.isFocused,i=t||r||"";return Object(j.f)(S,{style:this.props.style,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave},Object(j.f)(k,a()({},this.props,{ref:this.refInput,suppressContentEditableWarning:!0,contentEditable:!this.props.disabled,isHovering:this.state.isHovering,isDisabled:this.props.disabled,onBlur:this.onBlur,onFocus:this.onFocus,onInput:this.onChangeUsingOnInput,onChange:this.onChangeUsingOnInput,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp}),i),!o&&!n&&Object(j.f)("div",{onClick:this.onClickIcon},Object(j.f)(x,null)))}}],[{key:"setValueOnEvent",value:function(e){var t=e.target.innerText||e.currentTarget.innerText;return e.target.value=t,e.currentTarget.value=t,e}}]),r}(v.a.Component);D.displayName="InputInline";var S=Object(g.a)("div",{target:"e9oz5gz0",label:"Wrapper"})({name:"1684o59",styles:"display:inline-flex;align-items:center;vertical-align:text-bottom;"}),k=Object(g.a)("div",{target:"e9oz5gz1",label:"Input"})("min-width:40px;margin:0;border:1px solid ",(function(e){return e.isHovering?e.theme.border:"transparent"}),";outline:none;line-height:inherit;border-radius:",Object(O.a)(.5),";background:transparent;&:focus,&:active{border:1px solid ",(function(e){return e.isDisabled?"transparent":e.theme.border}),";background-color:",(function(e){return e.isDisabled?"transparent":e.theme.gray200}),";}"),x=Object(g.a)(y.u,{target:"e9oz5gz2",label:"StyledIconEdit"})("color:",(function(e){return e.theme.gray300}),";margin-left:",Object(O.a)(.5),";&:hover{cursor:pointer;}");t.a=D},2266:function(e,t,r){"use strict";var n=r(8),a=r.n(n),o=r(9),i=r.n(o),c=r(10),s=r.n(c),u=r(11),d=r.n(u),l=r(13),f=r.n(l),p=r(5),b=r.n(p),g=r(3),h=r(1),v=r.n(h),y=r(12),O=r(60),m=r.n(O),j=r(707),w=r(1902),D=r(1893),S=r(1900),k=r(1904),x=r(1906),C=r(218),E=r(153),P=r(118),z=r(234),R=r(16),U=r(4),I=r(7),M=r(1891),W=r(63),T=r(204),L=r(31),A=r(50),H=r(317),q=r(58),N=r(1887),F=r(22),G=r.n(F),B=r(30),V=r.n(B),K=r(29),J=r.n(K),Y=r(1964),_=r(46);function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}function $(e,t){return{seriesName:t,data:e.data.map((function(e){var t=J()(e,2);return{name:1e3*t[0],value:t[1].reduce((function(e,t){return e+t.count}),0)}}))}}function ee(e,t){var r=[],n=e.name;if(Object(C.f)(t)){var a=Object.keys(t).map((function(e){var r=n?"".concat(n," : ").concat(e):e,a=t[e];return[a.order||0,$(a,r)]})).sort((function(e,t){return e[0]-t[0]})).map((function(e){return e[1]}));r=r.concat(a)}else{var o=e.fields[0],i=n?"".concat(n," : ").concat(o):o,c=$(t,i);r.push(c)}return r}var te=function(e){d()(n,e);var t,r=Z(n);function n(){var e;i()(this,n);for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return(e=r.call.apply(r,[this].concat(a))).state={loading:!0,errorMessage:void 0,results:[]},e}return s()(n,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.selection,n=t.widget;m()(n.interval,e.widget.interval)&&m()(n.queries,e.widget.queries)&&m()(r,e.selection)||this.fetchData()}},{key:"fetchData",value:(t=V()(G.a.mark((function e(){var t,r,n,a,o,i,c,s,u,d,l,f,p,b,g=this;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,r=t.selection,n=t.api,a=t.organization,o=t.widget,this.setState({loading:!0,results:[]}),i=r.datetime.period,c=r.datetime,s=c.start,u=c.end,d=r.projects,l=r.environments,h=o.interval,v={start:s,end:u,period:i},y=void 0,y=Object(_.n)(h),f=Object(C.c)(v)/y>4e3?Object(C.d)(v,!0):h,p=o.queries.map((function(e){var t={organization:a,interval:f,start:s,end:u,project:d,environment:l,period:i,query:e.conditions,yAxis:e.fields,includePrevious:!1};return Object(Y.a)(n,t)})),b=0,p.forEach(function(){var e=V()(G.a.mark((function e(t,r){var n,a,i;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:n=e.sent,b++,g.setState((function(e){var t=e.results.concat(ee(o.queries[r],n));return Q(Q({},e),{},{results:t,errorMessage:void 0,loading:b!==p.length})})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),i=(null===e.t0||void 0===e.t0?void 0:null===(a=e.t0.responseJSON)||void 0===a?void 0:a.detail)||Object(U.b)("An unknown error occurred."),g.setState({errorMessage:i});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r){return e.apply(this,arguments)}}());case 9:case"end":return e.stop()}var h,v,y}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.props.children,t=this.state;return e({loading:t.loading,results:t.results,errorMessage:t.errorMessage})}}]),n}(v.a.Component);te.displayName="WidgetQueries";var re=te,ne=r(0);function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var ce=function(e){d()(r,e);var t=ie(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"shouldComponentUpdate",value:function(e){return!m()(e.widget,this.props.widget)||!m()(e.selection,this.props.selection)||this.props.isEditing!==e.isEditing||this.props.isDragging!==e.isDragging||this.props.hideToolbar!==e.hideToolbar}},{key:"chartComponent",value:function(e){switch(this.props.widget.displayType){case"bar":return Object(ne.f)(j.a,e);case"line":default:return Object(ne.f)(S.a,e)}}},{key:"renderVisual",value:function(e){var t,r,n,a=this,o=e.results,i=e.errorMessage,c=e.loading,s=this.props,u=s.location,d=s.router,l=s.selection,f=s.widget,p=l.datetime,b=p.start,g=p.end,h=p.period,v={right:10,top:5,icon:"circle",itemHeight:8,itemWidth:8,itemGap:12,align:"left",type:"plain",textStyle:{verticalAlign:"top",fontSize:11,fontFamily:"Rubik"},selected:Object(C.e)(u),formatter:function(e){var t=Object(W.n)(e);if(null!==t){var r=Object(W.o)(t);null!==r&&(e=r.toUpperCase())}return e}},y=null!==(t=null===(r=f.queries[0])||void 0===r?void 0:null===(n=r.fields)||void 0===n?void 0:n[0])&&void 0!==t?t:"count()",O={grid:{left:"0px",right:"0px",top:"40px",bottom:"10px"},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:M.c},yAxis:{axisLabel:{color:L.b.chartLabel,formatter:function(e){return Object(M.b)(e,y)}}}};return Object(ne.f)(w.a,{router:d,period:h,start:b,end:g},(function(e){if(i)return Object(ne.f)(D.a,null,Object(ne.f)(R.Hb,{color:"gray500",size:"lg"}));var t=o?L.b.charts.getColorPalette(o.length-2):[],r=o?o.map((function(e,r){return oe(oe({},e),{},{color:t[r]})})):[];return Object(ne.f)(k.a,{loading:c,reloading:c},Object(ne.f)(x.a,{visible:c}),Object(T.a)({value:a.chartComponent(oe(oe(oe({},e),O),{},{legend:v,series:r})),fixed:"Widget Chart"}))}))}},{key:"renderToolbar",value:function(){if(!this.props.isEditing)return null;if(this.props.hideToolbar)return Object(ne.f)(de,null);var e=this.props,t=e.onEdit,r=e.onDelete,n=e.startWidgetDrag;return Object(ne.f)(de,null,Object(ne.f)(le,{"data-component":"icon-container"},Object(ne.f)(pe,{color:"gray500",size:"md",onMouseDown:function(e){return n(e)},onTouchStart:function(e){return n(e)}}),Object(ne.f)(fe,{"data-test-id":"widget-edit",onClick:function(){t()}},Object(ne.f)(R.u,{color:"gray500",size:"md"})),Object(ne.f)(fe,{"data-test-id":"widget-delete",onClick:function(){r()}},Object(ne.f)(R.r,{color:"gray500",size:"md"}))))}},{key:"render",value:function(){var e=this,t=this.props,r=t.widget,n=t.isDragging,a=t.api,o=t.organization,i=t.selection,c=t.renderErrorMessage;return Object(ne.f)(E.a,{customComponent:Object(ne.f)(se,null,Object(U.b)("Error loading widget data"))},Object(ne.f)(ue,{isDragging:n},Object(ne.f)(re,{api:a,organization:o,widget:r,selection:i},(function(t){var n=t.results,a=t.errorMessage,o=t.loading;return Object(ne.f)(v.a.Fragment,null,"function"==typeof c?c(a):null,Object(ne.f)(N.a,null,Object(ne.f)(N.g,null,r.title),e.renderVisual({results:n,errorMessage:a,loading:o}),e.renderToolbar()))}))))}}]),r}(v.a.Component);ce.displayName="WidgetCard";t.a=Object(A.a)(Object(q.a)(Object(H.a)(y.withRouter(ce))));var se=Object(g.a)(z.a,{target:"e1n2ojl30",label:"ErrorCard"})("display:flex;align-items:center;justify-content:center;background-color:",(function(e){return e.theme.alert.error.backgroundLight}),";border:1px solid ",(function(e){return e.theme.alert.error.border}),";color:",(function(e){return e.theme.alert.error.textLight}),";border-radius:",(function(e){return e.theme.borderRadius}),";margin-bottom:",Object(I.a)(2),";"),ue=Object(g.a)(P.a,{shouldForwardProp:function(e){return"isDragging"!==e},target:"e1n2ojl31",label:"StyledPanel"})("margin:0;visibility:",(function(e){return e.isDragging?"hidden":"visible"}),";"),de=Object(g.a)("div",{target:"e1n2ojl32",label:"ToolbarPanel"})({name:"hm5z1d",styles:"position:absolute;top:0;left:0;z-index:1;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(255,255,255,0.5);"}),le=Object(g.a)("div",{target:"e1n2ojl33",label:"IconContainer"})({name:"1tmn3mk",styles:"display:flex;> * + *{margin-left:50px;}"}),fe=Object(g.a)("div",{target:"e1n2ojl34",label:"IconClick"})({name:"1p3qk0r",styles:"&:hover{cursor:pointer;}"}),pe=Object(g.a)(R.G,{target:"e1n2ojl35",label:"StyledIconGrabbable"})({name:"1fhyj3b",styles:"&:hover{cursor:grab;}"})},2726:function(e,t,r){"use strict";r.r(t);var n=r(8),a=r.n(n),o=r(9),i=r.n(o),c=r(10),s=r.n(c),u=r(11),d=r.n(u),l=r(13),f=r.n(l),p=r(5),b=r.n(p),g=r(3),h=r(1),v=r.n(h),y=r(12),O=r(60),m=r.n(O),j=r(2196),w=r(34),D=r(721),S=r(44),k=r(705),x=r(4),C=r(7),E=r(50),P=r(58),z=r(26),R=r(81),U=r(139),I=r(119),M=r(16),W=r(0);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var L=function(e){d()(r,e);var t=T(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"render",value:function(){var e=this,t=this.props,r=t.dashboardState,n=t.dashboards,a=t.dashboard,o=t.onEdit,i=t.onCreate,c=t.onCancel,s=t.onCommit,u=t.onDelete,d=Object(W.f)(z.b,{"data-test-id":"dashboard-cancel",onClick:function(e){e.preventDefault(),c()}},Object(x.b)("Cancel"));if(["edit","pending_delete"].includes(r))return Object(W.f)(R.a,{gap:1,key:"edit-controls"},d,Object(W.f)(U.a,{priority:"danger",message:Object(x.b)("Are you sure you want to delete this dashboard?"),onConfirm:u},Object(W.f)(z.b,{"data-test-id":"dashboard-delete",priority:"danger"},Object(x.b)("Delete"))),Object(W.f)(z.b,{"data-test-id":"dashboard-commit",onClick:function(e){e.preventDefault(),s()},priority:"primary"},Object(x.b)("Save and Finish")));if("create"===r)return Object(W.f)(R.a,{gap:1,key:"create-controls"},d,Object(W.f)(z.b,{"data-test-id":"dashboard-commit",onClick:function(e){e.preventDefault(),s()},priority:"primary"},Object(x.b)("Save and Finish")));var l=n.map((function(e){return{label:e.title,value:e}})),f=void 0;return a?f={label:a.title,value:a}:l.length&&(f=l[0]),Object(W.f)(H,{gap:1,key:"controls"},Object(W.f)(A,null,Object(W.f)(I.a,{key:"select",name:"parameter",placeholder:Object(x.b)("Select Dashboard"),options:l,value:f,onChange:function(t){var r=t.value,n=e.props.organization;y.browserHistory.push({pathname:"/organizations/".concat(n.slug,"/dashboards/").concat(r.id,"/"),query:{}})}})),Object(W.f)(z.b,{"data-test-id":"dashboard-create",onClick:function(e){e.preventDefault(),i()},icon:Object(W.f)(M.b,{size:"xs",isCircled:!0})},Object(x.b)("Create Dashboard")),Object(W.f)(z.b,{"data-test-id":"dashboard-edit",onClick:function(e){e.preventDefault(),o()},priority:"primary",icon:Object(W.f)(M.u,{size:"xs"})},Object(x.b)("Edit Dashboard")))}}]),r}(v.a.Component);L.displayName="Controls";var A=Object(g.a)("div",{target:"e104d2ty0",label:"DashboardSelect"})("min-width:200px;font-size:",(function(e){return e.theme.fontSizeMedium}),";"),H=Object(g.a)(R.a,{target:"e104d2ty1",label:"StyledButtonBar"})("@media (max-width:",(function(e){return e.theme.breakpoints[0]}),"){grid-auto-flow:row;grid-row-gap:",Object(C.a)(1),";width:100%;}"),q=L,N=r(24),F=r.n(N),G=r(39),B=r.n(G),V=r(732),K=r.n(V),J=r(62),Y=r(566),_=r(31),X=r(2197),Q=r(2051),Z=r(317),$=r(2266);function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var ne=function(e){d()(r,e);var t=re(r);function r(e){var n;i()(this,r),(n=t.call(this,e)).state={draggingIndex:void 0,draggingTargetIndex:void 0,isDragging:!1,top:void 0,left:void 0,widgets:void 0},n.previousUserSelect=null,n.portal=null,n.dragGhostRef=v.a.createRef(),n.handleStartAdd=function(){var e=n.props,t=e.organization,r=e.dashboard,a=e.selection;Object(J.b)({organization:t,dashboard:r,selection:a,onAddWidget:n.handleAddComplete})},n.handleAddComplete=function(e){n.props.onUpdate([].concat(F()(n.props.dashboard.widgets),[e]))},n.handleUpdateComplete=function(e){return function(t){var r=F()(n.props.dashboard.widgets);r[e]=t,n.props.onUpdate(r)}},n.handleDeleteWidget=function(e){return function(){var t=F()(n.props.dashboard.widgets);t.splice(e,1),n.props.onUpdate(t)}},n.handleEditWidget=function(e,t){return function(){var r=n.props,a=r.organization,o=r.dashboard,i=r.selection;Object(J.b)({organization:a,dashboard:o,widget:e,selection:i,onAddWidget:n.handleAddComplete,onUpdateWidget:n.handleUpdateComplete(t)})}},n.startWidgetDrag=function(e){return function(t){if(!n.state.isDragging&&["mousedown","touchstart"].includes(t.type)){t.preventDefault(),t.stopPropagation(),n.previousUserSelect=Object(Q.a)({userSelect:"none",MozUserSelect:"none",msUserSelect:"none",webkitUserSelect:"none"}),window.addEventListener("mousemove",n.onWidgetDragMove),window.addEventListener("mouseup",n.onWidgetDragEnd),t.target.addEventListener("touchmove",n.onWidgetDragMove),t.persist();t.target.addEventListener("touchend",(function e(){t.target&&(t.target.removeEventListener("touchmove",n.onWidgetDragMove),t.target.removeEventListener("touchend",e))}));var r=document.querySelectorAll('[data-component="widget-wrapper"]')[e],a=r.getBoundingClientRect();if(n.dragGhostRef.current){var o=n.dragGhostRef.current,i=r.cloneNode(!0);i.removeAttribute("data-component");var c=i.querySelector('[data-component="icon-container"]');c&&c.parentNode&&c.parentNode.removeChild(c),i.style.width="".concat(a.width,"px"),i.style.height="".concat(a.height,"px"),o.appendChild(i),o.style.left="".concat(Object(X.a)(t,"pageX")-20,"px"),o.style.top="".concat(Object(X.a)(t,"pageY")-20,"px")}n.setState({isDragging:!0,draggingIndex:e,draggingTargetIndex:e,top:Object(X.a)(t,"pageY"),left:Object(X.a)(t,"pageX"),widgets:n.shallowCloneWidgets()})}}},n.onWidgetDragMove=function(e){if(n.state.isDragging&&["mousemove","touchmove"].includes(e.type)&&n.state.widgets&&void 0!==n.state.draggingIndex){if(e.preventDefault(),e.stopPropagation(),n.dragGhostRef.current){var t=n.dragGhostRef.current;t.style.left="".concat(Object(X.a)(e,"pageX")-20,"px"),t.style.top="".concat(Object(X.a)(e,"pageY")-20,"px")}var r=document.querySelectorAll('[data-component="widget-wrapper"]'),a=Array.from(r).findIndex((function(t){var r=t.getBoundingClientRect(),n=Object(X.a)(e,"clientY"),a=Object(X.a)(e,"clientX"),o=r.top,i=r.top+r.height,c=r.left,s=r.left+r.width;return o<=n&&n<=i&&c<=a&&a<=s}));if(a>=0&&a!==n.state.draggingTargetIndex){var o=n.shallowCloneWidgets(),i=o.splice(n.state.draggingIndex,1);o.splice(a,0,i[0]),n.setState({draggingTargetIndex:a,widgets:o})}}},n.onWidgetDragEnd=function(e){if(n.state.isDragging&&["mouseup","touchend"].includes(e.type)){var t=n.state.draggingIndex,r=n.state.draggingTargetIndex;if("number"==typeof t&&"number"==typeof r){if(n.cleanUpListeners(),n.previousUserSelect&&(Object(Q.a)(n.previousUserSelect),n.previousUserSelect=null),n.dragGhostRef.current)n.dragGhostRef.current.innerHTML="";if(t!==r){var a=F()(n.props.dashboard.widgets),o=a.splice(t,1);a.splice(r,0,o[0]),n.props.onUpdate(a)}n.setState({isDragging:!1,left:void 0,top:void 0,draggingIndex:void 0,draggingTargetIndex:void 0,widgets:void 0})}}},n.renderGhost=function(){if(!n.portal)return null;var e="number"==typeof n.state.top?n.state.top-20:0,t="number"==typeof n.state.left?n.state.left-20:0,r=Object(W.f)(se,{id:"ghost",ref:n.dragGhostRef,style:{top:"".concat(e,"px"),left:"".concat(t,"px")}});return B.a.createPortal(r,n.portal)};var a=document.createElement("div");return a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.zIndex=String(_.b.zIndex.modal),n.portal=a,n}return s()(r,[{key:"componentDidMount",value:function(){this.props.isEditing&&this.fetchTags(),this.portal&&document.body.appendChild(this.portal)}},{key:"componentDidUpdate",value:function(e){var t=this.props.isEditing;e.isEditing!==t&&t&&this.fetchTags()}},{key:"componentWillUnmount",value:function(){this.portal&&document.body.removeChild(this.portal),this.cleanUpListeners()}},{key:"fetchTags",value:function(){var e=this.props,t=e.api,r=e.organization,n=e.selection;Object(Y.c)(t,r.slug,n)}},{key:"cleanUpListeners",value:function(){this.state.isDragging&&(window.removeEventListener("mousemove",this.onWidgetDragMove),window.removeEventListener("mouseup",this.onWidgetDragEnd))}},{key:"shallowCloneWidgets",value:function(){return this.props.dashboard.widgets.map((function(e,t){var r;return te(te({},e),{},{id:null!==(r=e.id)&&void 0!==r?r:String(t)})}))}},{key:"renderWidget",value:function(e,t){var r,n=this.props.isEditing;return Object(W.f)(K.a,{key:"".concat(null!==(r=e.id)&&void 0!==r?r:t),once:!0,height:240,offset:100},Object(W.f)(ie,{"data-component":"widget-wrapper"},Object(W.f)($.a,{widget:e,isEditing:n,onDelete:this.handleDeleteWidget(t),onEdit:this.handleEditWidget(e,t),isDragging:this.state.isDragging&&this.state.draggingTargetIndex===t,hideToolbar:this.state.isDragging,startWidgetDrag:this.startWidgetDrag(t)})))}},{key:"render",value:function(){var e=this,t=this.props,r=t.isEditing,n=t.dashboard,a=this.state.isDragging&&this.state.widgets?this.state.widgets:n.widgets;return Object(W.f)(oe,null,a.map((function(t,r){return e.renderWidget(t,r)})),r&&Object(W.f)(ie,{key:"add"},Object(W.f)(ce,{key:"add","data-test-id":"widget-add",onClick:this.handleStartAdd},Object(W.f)(M.b,{size:"lg",isCircled:!0,color:"inactive"}))),this.renderGhost())}}]),r}(v.a.Component);ne.displayName="Dashboard";var ae=Object(E.a)(Object(Z.a)(ne)),oe=Object(g.a)("div",{target:"e1nz851n0",label:"WidgetContainer"})("display:grid;grid-template-columns:repeat(2,1fr);grid-gap:",Object(C.a)(2),";@media (max-width:",(function(e){return e.theme.breakpoints[1]}),"){grid-template-columns:1fr;}"),ie=Object(g.a)("div",{target:"e1nz851n1",label:"WidgetWrapper"})({name:"79elbk",styles:"position:relative;"}),ce=Object(g.a)("a",{target:"e1nz851n2",label:"AddWidgetWrapper"})("width:100%;height:100%;min-height:200px;border:2px dashed ",(function(e){return e.theme.border}),";border-radius:",(function(e){return e.theme.borderRadius}),";display:flex;align-items:center;justify-content:center;"),se=Object(g.a)("div",{target:"e1nz851n3",label:"WidgetGhost"})("display:block;position:absolute;cursor:grabbing;opacity:0.8;box-shadow:",(function(e){return e.theme.dropShadowHeavy}),";border-radius:",(function(e){return e.theme.borderRadius}),";"),ue=r(2204),de=r(126),le=r.n(de),fe=r(423),pe=r(706),be=r(1890),ge=r(217);function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var Oe=function(e){d()(r,e);var t=ye(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={loading:!0,reloading:!1,error:!1,errors:[],dashboards:[],selectedDashboard:null},e}return s()(r,[{key:"getEndpoints",value:function(){var e=this.props,t=e.organization,r=e.params,n="/organizations/".concat(t.slug,"/dashboards/"),a=[["dashboards",n]];return r.dashboardId&&a.push(["selectedDashboard","".concat(n).concat(r.dashboardId,"/")]),a}},{key:"getDashboards",value:function(){var e=this.state.dashboards;return Array.isArray(e)?e:[]}},{key:"onRequestSuccess",value:function(e){var t=e.stateKey,r=e.data,n=this.props,a=n.params,o=n.organization;if(!a.dashboardId&&"selectedDashboard"!==t){var i=r.length?r[0].id:"default-overview",c="/organizations/".concat(o.slug,"/dashboards/").concat(i,"/");y.browserHistory.replace({pathname:c})}}},{key:"renderBody",value:function(){var e=this.props,t=e.organization,r=e.children,n=this.state,a=n.selectedDashboard,o=n.error;return Object(W.f)(ge.b,null,Object(W.f)(pe.a,{organization:t},r({error:o,dashboard:a,dashboards:this.getDashboards(),reloadData:this.reloadData.bind(this)})))}},{key:"renderError",value:function(e){return Object.values(this.state.errors).find((function(e){return e&&404===e.status}))?Object(W.f)(D.a,null):le()(b()(r.prototype),"renderError",this).call(this,e,!0,!0)}},{key:"renderComponent",value:function(){var e=this.props,t=e.organization,n=e.location;return t.features.includes("dashboards-v2")?Object(W.f)(be.a,{title:Object(x.b)("Dashboards"),objSlug:t.slug},le()(b()(r.prototype),"renderComponent",this).call(this)):(y.browserHistory.replace({pathname:"/organizations/".concat(t.slug,"/dashboards/"),query:ve({},n.query)}),null)}}]),r}(fe.a),me=r(6),je=r.n(me),we=r(2205);function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var xe=function(e){d()(r,e);var t=ke(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).refInput=v.a.createRef(),e.onBlur=function(t){var r=(t.target.value||"").trim().slice(0,255).trim();if(!r)return Object(w.a)(Object(x.b)("Please set the title for this dashboard")),void(e.refInput.current&&e.refInput.current.focus());var n=e.props,a=n.dashboard,o=n.onUpdate;a&&(t.target.innerText=r,o(Se(Se({},a),{},{title:r})))},e}return s()(r,[{key:"render",value:function(){var e=this.props,t=e.dashboard,r=e.isEditing;return t?r?Object(W.f)(Ce,null,Object(W.f)(Ee,{name:"dashboard-title",ref:this.refInput,value:t.title,onBlur:this.onBlur})):Object(W.f)(Ce,null,t.title):Object(W.f)(Ce,null,Object(x.b)("Dashboards"))}}]),r}(v.a.Component);xe.displayName="DashboardTitle";var Ce=Object(g.a)("div",{target:"e14jh2hu0",label:"Container"})("margin-right:",Object(C.a)(1),";@media (max-width:",(function(e){return e.theme.breakpoints[2]}),"){margin-right:0;margin-bottom:",Object(C.a)(2),";}"),Ee=Object(g.a)(v.a.forwardRef((function(e,t){return Object(W.f)(we.a,je()({},e,{ref:t}))})),{target:"e14jh2hu1",label:"StyledInlineInput"})({name:"1370mw6",styles:"overflow-wrap:anywhere;white-space:normal;"}),Pe=xe,ze=r(728),Re=r.n(ze);function Ue(e){return Re()(e)}function Ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var Te=Object(x.b)("You have unsaved changes are you sure you want to leave?"),Le=function(e){d()(r,e);var t=We(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={dashboardState:"view",modifiedDashboard:null},e.onEdit=function(t){return function(){t&&e.setState({dashboardState:"edit",modifiedDashboard:Ue(t)})}},e.onRouteLeave=function(){if(!["view","pending_delete"].includes(e.state.dashboardState))return Te},e.onUnload=function(t){["view","pending_delete"].includes(e.state.dashboardState)||(t.preventDefault(),t.returnValue=Te)},e.onCreate=function(){e.setState({dashboardState:"create",modifiedDashboard:Ue(ue.b)})},e.onCancel=function(){e.setState({dashboardState:"view",modifiedDashboard:null})},e.onDelete=function(t){return function(){var r=e.props,n=r.api,a=r.organization;if(null==t?void 0:t.id){var o=e.state.dashboardState;e.setState({dashboardState:"pending_delete"},(function(){Object(j.b)(n,a.slug,t.id).then((function(){Object(w.d)(Object(x.b)("Dashboard deleted")),y.browserHistory.replace({pathname:"/organizations/".concat(a.slug,"/dashboards/"),query:{}})})).catch((function(){e.setState({dashboardState:o})}))}))}}},e.onCommit=function(t){var r=t.dashboard,n=t.reloadData;return function(){var t=e.props,a=t.api,o=t.organization,i=t.location,c=e.state,s=c.dashboardState,u=c.modifiedDashboard;switch(s){case"create":u&&Object(j.a)(a,o.slug,u).then((function(t){Object(w.d)(Object(x.b)("Dashboard created")),e.setState({dashboardState:"view",modifiedDashboard:null}),y.browserHistory.replace({pathname:"/organizations/".concat(o.slug,"/dashboards/").concat(t.id,"/"),query:Me({},i.query)})}));break;case"edit":if(u)return m()(r,u)?void e.setState({dashboardState:"view",modifiedDashboard:null}):void Object(j.c)(a,o.slug,u).then((function(t){Object(w.d)(Object(x.b)("Dashboard updated")),e.setState({dashboardState:"view",modifiedDashboard:null}),r&&t.id!==r.id?y.browserHistory.replace({pathname:"/organizations/".concat(o.slug,"/dashboards/").concat(t.id,"/"),query:Me({},i.query)}):n()}));e.setState({dashboardState:"view",modifiedDashboard:null});break;case"view":default:e.setState({dashboardState:"view",modifiedDashboard:null})}}},e.onWidgetChange=function(t){var r=e.state.modifiedDashboard;null!==r&&e.setState((function(e){return Me(Me({},e),{},{modifiedDashboard:Me(Me({},r),{},{widgets:t})})}))},e.setModifiedDashboard=function(t){e.setState({modifiedDashboard:t})},e}return s()(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.route;e.router.setRouteLeaveHook(t,this.onRouteLeave),window.addEventListener("beforeunload",this.onUnload)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.onUnload)}},{key:"render",value:function(){var e=this,t=this.props,r=t.api,n=t.location,a=t.params,o=t.organization,i=this.state,c=i.modifiedDashboard,s=i.dashboardState,u=["edit","create","pending_delete"].includes(s);return Object(W.f)(k.a,{skipLoadLastUsed:o.features.includes("global-views")},Object(W.f)(Oe,{api:r,location:n,params:a,organization:o},(function(t){var r=t.dashboard,n=t.dashboards,a=t.error,i=t.reloadData;return Object(W.f)(v.a.Fragment,null,Object(W.f)(Ae,null,Object(W.f)(Pe,{dashboard:c||r,onUpdate:e.setModifiedDashboard,isEditing:u}),Object(W.f)(q,{organization:o,dashboards:n,dashboard:r,onEdit:e.onEdit(r),onCreate:e.onCreate,onCancel:e.onCancel,onCommit:e.onCommit({dashboard:r,reloadData:i}),onDelete:e.onDelete(r),dashboardState:s})),a?Object(W.f)(D.a,null):r?Object(W.f)(ae,{dashboard:c||r,organization:o,isEditing:u,onUpdate:e.onWidgetChange}):Object(W.f)(S.default,null))})))}}]),r}(v.a.Component);Le.displayName="DashboardDetail";var Ae=Object(g.a)("div",{target:"e39ap620",label:"StyledPageHeader"})("display:flex;align-items:center;justify-content:space-between;font-size:",(function(e){return e.theme.headerFontSize}),";color:",(function(e){return e.theme.textColor}),";height:40px;margin-bottom:",Object(C.a)(1),";@media (max-width:",(function(e){return e.theme.breakpoints[2]}),"){flex-direction:column;align-items:flex-start;height:auto;}");t.default=Object(E.a)(Object(P.a)(Le))}}]);
//# sourceMappingURL=DashboardDetail~OverviewDashboard.js.map