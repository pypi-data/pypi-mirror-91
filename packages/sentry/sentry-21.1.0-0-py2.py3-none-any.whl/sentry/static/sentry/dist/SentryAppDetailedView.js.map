{"version":3,"sources":["webpack:////workspace/node_modules/lodash/groupBy.js","webpack:///./app/utils/consolidatedScopes.tsx","webpack:////workspace/node_modules/lodash/invertBy.js","webpack:////workspace/node_modules/lodash/_createInverter.js","webpack:////workspace/node_modules/lodash/_baseInverter.js","webpack:///./app/actionCreators/sentryAppInstallations.tsx","webpack:///./app/views/organizationIntegrations/SplitInstallationIdModal.tsx","webpack:///./app/views/organizationIntegrations/sentryAppDetailedView.tsx"],"names":["baseAssignValue","createAggregator","hasOwnProperty","Object","prototype","groupBy","result","value","key","call","push","module","exports","PERMISSION_LEVELS","read","write","admin","HUMAN_RESOURCE_NAMES","project","team","release","event","org","member","DEFAULT_RESOURCE_PERMISSIONS","Project","Team","Release","Event","Organization","Member","permissionLevel","scope","permission","split","compareScopes","a","b","toResourcePermissions","scopes","scopeList","permissions","filteredScopes","includes","filter","values","map","sort","pop","forEach","resource","toPermissions","resourcePermissions","pick","invertBy","baseIteratee","createInverter","objectProto","nativeObjectToString","toString","baseInverter","setter","toIteratee","object","iteratee","baseForOwn","accumulator","installSentryApp","client","orgId","app","addLoadingMessage","promise","requestPromise","method","data","slug","then","clearIndicators","addErrorMessage","t","name","uninstallSentryApp","install","uuid","addSuccessMessage","SplitInstallationIdModal","onCopy","navigator","clipboard","writeText","props","installationId","handleContinue","setTimeout","window","open","this","closeModal","ItemHolder","ButtonHolder","size","onClick","priority","React","Component","SentryAppDetailedView","tabs","redirectUser","organization","sentryApp","state","queryParams","code","orgSlug","redirectUrl","addQueryParamsToExistingUrl","location","assign","handleInstall","trackIntegrationEvent","eventKey","eventName","integration_status","status","api","setState","appInstalls","openModal","handleUninstall","i","recordUninstallClicked","integrationSlug","params","router","recordInteraction","keys","some","length","PermissionWrapper","Title","Permission","Indicator","Text","tct","resources","join","disabledFromFeatures","userHasAccess","disabled","message","onConfirm","onConfirming","StyledUninstallButton","data-test-id","isCircled","style","marginRight","space","InstallButton","marginLeft","renderRequestIntegrationButton","overview","author","title","url","getSentryAppInstallStatus","featureData","find","AbstractIntegrationDetailedView","p","theme","success","Button","gray300","background","withOrganization"],"mappings":"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","file":"SentryAppDetailedView.js","sourcesContent":["var baseAssignValue = require('./_baseAssignValue'),\n    createAggregator = require('./_createAggregator');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an object composed of keys generated from the results of running\n * each element of `collection` thru `iteratee`. The order of grouped values\n * is determined by the order they occur in `collection`. The corresponding\n * value of each key is an array of elements responsible for generating the\n * key. The iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n * @returns {Object} Returns the composed aggregate object.\n * @example\n *\n * _.groupBy([6.1, 4.2, 6.3], Math.floor);\n * // => { '4': [4.2], '6': [6.1, 6.3] }\n *\n * // The `_.property` iteratee shorthand.\n * _.groupBy(['one', 'two', 'three'], 'length');\n * // => { '3': ['one', 'two'], '5': ['three'] }\n */\nvar groupBy = createAggregator(function(result, value, key) {\n  if (hasOwnProperty.call(result, key)) {\n    result[key].push(value);\n  } else {\n    baseAssignValue(result, key, [value]);\n  }\n});\n\nmodule.exports = groupBy;\n","import groupBy from 'lodash/groupBy';\nimport invertBy from 'lodash/invertBy';\nimport pick from 'lodash/pick';\n\nimport {Permissions} from 'app/types';\n\nconst PERMISSION_LEVELS = {\n  read: 0,\n  write: 1,\n  admin: 2,\n};\n\nconst HUMAN_RESOURCE_NAMES = {\n  project: 'Project',\n  team: 'Team',\n  release: 'Release',\n  event: 'Event',\n  org: 'Organization',\n  member: 'Member',\n};\n\nconst DEFAULT_RESOURCE_PERMISSIONS: Permissions = {\n  Project: 'no-access',\n  Team: 'no-access',\n  Release: 'no-access',\n  Event: 'no-access',\n  Organization: 'no-access',\n  Member: 'no-access',\n};\n\nconst PROJECT_RELEASES = 'project:releases';\n\ntype PermissionLevelResources = {\n  read: string[];\n  write: string[];\n  admin: string[];\n};\n/**\n * Numerical value of the scope where Admin is higher than Write,\n * which is higher than Read. Used to sort scopes by access.\n */\nconst permissionLevel = (scope: string): number => {\n  const permission = scope.split(':')[1];\n  return PERMISSION_LEVELS[permission];\n};\n\nconst compareScopes = (a: string, b: string) => permissionLevel(a) - permissionLevel(b);\n\n/**\n * Return the most permissive scope for each resource.\n *\n * Example:\n *    Given the full list of scopes:\n *      ['project:read', 'project:write', 'team:read', 'team:write', 'team:admin']\n *\n *    this would return:\n *      ['project:write', 'team:admin']\n */\nfunction topScopes(scopeList: string[]) {\n  return Object.values(groupBy(scopeList, scope => scope.split(':')[0]))\n    .map(scopes => scopes.sort(compareScopes))\n    .map(scopes => scopes.pop());\n}\n\n/**\n * Convert into a list of Permissions, grouped by resource.\n *\n * This is used in the new/edit Sentry App form. That page displays permissions\n * in a per-Resource manner, meaning one row for Project, one for Organization, etc.\n *\n * This exposes scopes in a way that works for that UI.\n *\n * Example:\n *    {\n *      'Project': 'read',\n *      'Organization': 'write',\n *      'Team': 'no-access',\n *      ...\n *    }\n */\nfunction toResourcePermissions(scopes: string[]): Permissions {\n  const permissions = {...DEFAULT_RESOURCE_PERMISSIONS};\n  let filteredScopes = [...scopes];\n  // The scope for releases is `project:releases`, but instead of displaying\n  // it as a permission of Project, we want to separate it out into its own\n  // row for Releases.\n  if (scopes.includes(PROJECT_RELEASES)) {\n    permissions.Release = 'admin';\n    filteredScopes = scopes.filter((scope: string) => scope !== PROJECT_RELEASES); // remove project:releases\n  }\n\n  topScopes(filteredScopes).forEach((scope: string | undefined) => {\n    if (scope) {\n      const [resource, permission] = scope.split(':');\n      permissions[HUMAN_RESOURCE_NAMES[resource]] = permission;\n    }\n  });\n\n  return permissions;\n}\n\n/**\n * Convert into a list of Permissions, grouped by access and including a\n * list of resources per access level.\n *\n * This is used in the Permissions Modal when installing an App. It displays\n * scopes in a per-Permission way, meaning one row for Read, one for Write,\n * and one for Admin.\n *\n * This exposes scopes in a way that works for that UI.\n *\n * Example:\n *    {\n *      read:  ['Project', 'Organization'],\n *      write: ['Member'],\n *      admin: ['Release']\n *    }\n */\nfunction toPermissions(scopes: string[]): PermissionLevelResources {\n  const defaultPermissions = {read: [], write: [], admin: []};\n  const resourcePermissions = toResourcePermissions(scopes);\n\n  // Filter out the 'no-access' permissions\n  const permissions = pick(invertBy(resourcePermissions), ['read', 'write', 'admin']);\n  return {...defaultPermissions, ...permissions};\n}\n\nexport {toPermissions, toResourcePermissions};\n","var baseIteratee = require('./_baseIteratee'),\n    createInverter = require('./_createInverter');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * This method is like `_.invert` except that the inverted object is generated\n * from the results of running each element of `object` thru `iteratee`. The\n * corresponding inverted value of each inverted key is an array of keys\n * responsible for generating the inverted value. The iteratee is invoked\n * with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.1.0\n * @category Object\n * @param {Object} object The object to invert.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {Object} Returns the new inverted object.\n * @example\n *\n * var object = { 'a': 1, 'b': 2, 'c': 1 };\n *\n * _.invertBy(object);\n * // => { '1': ['a', 'c'], '2': ['b'] }\n *\n * _.invertBy(object, function(value) {\n *   return 'group' + value;\n * });\n * // => { 'group1': ['a', 'c'], 'group2': ['b'] }\n */\nvar invertBy = createInverter(function(result, value, key) {\n  if (value != null &&\n      typeof value.toString != 'function') {\n    value = nativeObjectToString.call(value);\n  }\n\n  if (hasOwnProperty.call(result, value)) {\n    result[value].push(key);\n  } else {\n    result[value] = [key];\n  }\n}, baseIteratee);\n\nmodule.exports = invertBy;\n","var baseInverter = require('./_baseInverter');\n\n/**\n * Creates a function like `_.invertBy`.\n *\n * @private\n * @param {Function} setter The function to set accumulator values.\n * @param {Function} toIteratee The function to resolve iteratees.\n * @returns {Function} Returns the new inverter function.\n */\nfunction createInverter(setter, toIteratee) {\n  return function(object, iteratee) {\n    return baseInverter(object, setter, toIteratee(iteratee), {});\n  };\n}\n\nmodule.exports = createInverter;\n","var baseForOwn = require('./_baseForOwn');\n\n/**\n * The base implementation of `_.invert` and `_.invertBy` which inverts\n * `object` with values transformed by `iteratee` and set by `setter`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} setter The function to set `accumulator` values.\n * @param {Function} iteratee The iteratee to transform values.\n * @param {Object} accumulator The initial inverted object.\n * @returns {Function} Returns `accumulator`.\n */\nfunction baseInverter(object, setter, iteratee, accumulator) {\n  baseForOwn(object, function(value, key, object) {\n    setter(accumulator, iteratee(value), key, object);\n  });\n  return accumulator;\n}\n\nmodule.exports = baseInverter;\n","import {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n  clearIndicators,\n} from 'app/actionCreators/indicator';\nimport {Client} from 'app/api';\nimport {t} from 'app/locale';\nimport {SentryApp, SentryAppInstallation} from 'app/types';\n\n/**\n * Install a sentry application\n *\n * @param {Object} client ApiClient\n * @param {String} orgId Organization Slug\n * @param {Object} app SentryApp\n */\nexport function installSentryApp(\n  client: Client,\n  orgId: string,\n  app: SentryApp\n): Promise<SentryAppInstallation> {\n  addLoadingMessage();\n  const promise = client.requestPromise(\n    `/organizations/${orgId}/sentry-app-installations/`,\n    {\n      method: 'POST',\n      data: {slug: app.slug},\n    }\n  );\n  promise.then(\n    () => clearIndicators(),\n    () => addErrorMessage(t(`Unable to install ${app.name}`))\n  );\n  return promise;\n}\n\n/**\n * Uninstall a sentry application\n *\n * @param {Object} client ApiClient\n * @param {Object} install SentryAppInstallation\n */\nexport function uninstallSentryApp(\n  client: Client,\n  install: SentryAppInstallation\n): Promise<void> {\n  addLoadingMessage();\n  const promise = client.requestPromise(`/sentry-app-installations/${install.uuid}/`, {\n    method: 'DELETE',\n  });\n  promise.then(\n    () => {\n      addSuccessMessage(t(`${install.app.slug} successfully uninstalled.`));\n    },\n    () => clearIndicators()\n  );\n  return promise;\n}\n","import React from 'react';\nimport styled from '@emotion/styled';\nimport PropTypes from 'prop-types';\n\nimport {addSuccessMessage} from 'app/actionCreators/indicator';\nimport Button from 'app/components/button';\nimport TextCopyInput from 'app/views/settings/components/forms/textCopyInput';\n\ntype Props = {\n  installationId: string;\n  closeModal: () => void;\n};\n\n/**\n * This component is a hack for Split.\n * It will display the installation ID after installation so users can copy it and paste it in Split's website.\n * We also have a link for users to click so they can go to Split's website.\n */\nexport default class SplitInstallationIdModal extends React.Component<Props> {\n  static propTypes = {\n    installationId: PropTypes.string.isRequired,\n    closeModal: PropTypes.func.isRequired,\n  };\n\n  onCopy = async () =>\n    //This hack is needed because the normal copying methods with TextCopyInput do not work correctly\n    await navigator.clipboard.writeText(this.props.installationId);\n\n  handleContinue = () => {\n    const delay = 2000;\n    this.onCopy();\n    addSuccessMessage('Copied to clipboard');\n    setTimeout(() => {\n      window.open('https://app.split.io/org/admin/integrations');\n    }, delay);\n  };\n\n  render() {\n    const {installationId, closeModal} = this.props;\n    //no need to translate this temporary component\n    return (\n      <div>\n        <ItemHolder>\n          Copy this Installation ID and click to continue. You will use it to finish setup\n          on Split.io.\n        </ItemHolder>\n        <ItemHolder>\n          <TextCopyInput onCopy={this.onCopy}>{installationId}</TextCopyInput>\n        </ItemHolder>\n        <ButtonHolder>\n          <Button size=\"small\" onClick={closeModal}>\n            Close\n          </Button>\n          <Button size=\"small\" priority=\"primary\" onClick={this.handleContinue}>\n            Copy and Open Link\n          </Button>\n        </ButtonHolder>\n      </div>\n    );\n  }\n}\n\nconst ItemHolder = styled('div')`\n  margin: 10px;\n`;\n\nconst ButtonHolder = styled(ItemHolder)`\n  text-align: right;\n  & button {\n    margin: 5px;\n  }\n`;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport {addErrorMessage, addSuccessMessage} from 'app/actionCreators/indicator';\nimport {openModal} from 'app/actionCreators/modal';\nimport {\n  installSentryApp,\n  uninstallSentryApp,\n} from 'app/actionCreators/sentryAppInstallations';\nimport Button from 'app/components/button';\nimport CircleIndicator from 'app/components/circleIndicator';\nimport Confirm from 'app/components/confirm';\nimport {IconSubtract} from 'app/icons';\nimport {t, tct} from 'app/locale';\nimport space from 'app/styles/space';\nimport {IntegrationFeature, SentryApp, SentryAppInstallation} from 'app/types';\nimport {toPermissions} from 'app/utils/consolidatedScopes';\nimport {getSentryAppInstallStatus} from 'app/utils/integrationUtil';\nimport {addQueryParamsToExistingUrl} from 'app/utils/queryString';\nimport {recordInteraction} from 'app/utils/recordSentryAppInteraction';\nimport withOrganization from 'app/utils/withOrganization';\n\nimport AbstractIntegrationDetailedView from './abstractIntegrationDetailedView';\nimport SplitInstallationIdModal from './SplitInstallationIdModal';\n\ntype State = {\n  sentryApp: SentryApp;\n  featureData: IntegrationFeature[];\n  appInstalls: SentryAppInstallation[];\n};\n\ntype Tab = AbstractIntegrationDetailedView['state']['tab'];\n\nclass SentryAppDetailedView extends AbstractIntegrationDetailedView<\n  AbstractIntegrationDetailedView['props'],\n  State & AbstractIntegrationDetailedView['state']\n> {\n  tabs: Tab[] = ['overview'];\n  getEndpoints(): ([string, string, any] | [string, string])[] {\n    const {\n      organization,\n      params: {integrationSlug},\n    } = this.props;\n    const baseEndpoints: ([string, string, any] | [string, string])[] = [\n      ['sentryApp', `/sentry-apps/${integrationSlug}/`],\n      ['featureData', `/sentry-apps/${integrationSlug}/features/`],\n      ['appInstalls', `/organizations/${organization.slug}/sentry-app-installations/`],\n    ];\n\n    return baseEndpoints;\n  }\n\n  onLoadAllEndpointsSuccess() {\n    const {\n      organization,\n      params: {integrationSlug},\n      router,\n    } = this.props;\n\n    //redirect for internal integrations\n    if (this.sentryApp.status === 'internal') {\n      router.push(\n        `/settings/${organization.slug}/developer-settings/${integrationSlug}/`\n      );\n      return;\n    }\n\n    super.onLoadAllEndpointsSuccess();\n    recordInteraction(integrationSlug, 'sentry_app_viewed');\n  }\n\n  get integrationType() {\n    return 'sentry_app' as const;\n  }\n\n  get sentryApp() {\n    return this.state.sentryApp;\n  }\n\n  get description() {\n    return this.state.sentryApp.overview || '';\n  }\n\n  get author() {\n    return this.sentryApp.author;\n  }\n\n  get resourceLinks() {\n    //only show links for published sentry apps\n    if (this.sentryApp.status !== 'published') {\n      return [];\n    }\n    return [\n      {\n        title: 'Documentation',\n        url: `https://docs.sentry.io/product/integrations/${this.integrationSlug}/`,\n      },\n    ];\n  }\n\n  get permissions() {\n    return toPermissions(this.sentryApp.scopes);\n  }\n\n  get installationStatus() {\n    return getSentryAppInstallStatus(this.install);\n  }\n\n  get integrationName() {\n    return this.sentryApp.name;\n  }\n\n  get featureData() {\n    return this.state.featureData;\n  }\n\n  get install() {\n    return this.state.appInstalls.find(i => i.app.slug === this.sentryApp.slug);\n  }\n\n  redirectUser = (install: SentryAppInstallation) => {\n    const {organization} = this.props;\n    const {sentryApp} = this.state;\n    const queryParams = {\n      installationId: install.uuid,\n      code: install.code,\n      orgSlug: organization.slug,\n    };\n    if (sentryApp.redirectUrl) {\n      const redirectUrl = addQueryParamsToExistingUrl(sentryApp.redirectUrl, queryParams);\n      window.location.assign(redirectUrl);\n    }\n  };\n\n  handleInstall = async () => {\n    const {organization} = this.props;\n    const {sentryApp} = this.state;\n    this.trackIntegrationEvent({\n      eventKey: 'integrations.installation_start',\n      eventName: 'Integrations: Installation Start',\n      integration_status: sentryApp.status,\n    });\n    // installSentryApp adds a message on failure\n    const install = await installSentryApp(this.api, organization.slug, sentryApp);\n\n    //installation is complete if the status is installed\n    if (install.status === 'installed') {\n      this.trackIntegrationEvent({\n        eventKey: 'integrations.installation_complete',\n        eventName: 'Integrations: Installation Complete',\n        integration_status: sentryApp.status,\n      });\n    }\n\n    if (!sentryApp.redirectUrl) {\n      addSuccessMessage(t(`${sentryApp.slug} successfully installed.`));\n      this.setState({appInstalls: [install, ...this.state.appInstalls]});\n\n      //hack for split so we can show the install ID to users for them to copy\n      //Will remove once the proper fix is in place\n      if (['split', 'split-dev', 'split-testing'].includes(sentryApp.slug)) {\n        openModal(({closeModal}) => (\n          <SplitInstallationIdModal\n            installationId={install.uuid}\n            closeModal={closeModal}\n          />\n        ));\n      }\n    } else {\n      this.redirectUser(install);\n    }\n  };\n\n  handleUninstall = async (install: SentryAppInstallation) => {\n    try {\n      await uninstallSentryApp(this.api, install);\n      this.trackIntegrationEvent({\n        eventKey: 'integrations.uninstall_completed',\n        eventName: 'Integrations: Uninstall Completed',\n        integration_status: this.sentryApp.status,\n      });\n      const appInstalls = this.state.appInstalls.filter(\n        i => i.app.slug !== this.sentryApp.slug\n      );\n      return this.setState({appInstalls});\n    } catch (error) {\n      return addErrorMessage(t(`Unable to uninstall ${this.sentryApp.name}`));\n    }\n  };\n\n  recordUninstallClicked = () => {\n    const sentryApp = this.sentryApp;\n    this.trackIntegrationEvent({\n      eventKey: 'integrations.uninstall_clicked',\n      eventName: 'Integrations: Uninstall Clicked',\n      integration_status: sentryApp.status,\n    });\n  };\n\n  renderPermissions() {\n    const permissions = this.permissions;\n    if (!Object.keys(permissions).some(scope => permissions[scope].length > 0)) {\n      return null;\n    }\n\n    return (\n      <PermissionWrapper>\n        <Title>Permissions</Title>\n        {permissions.read.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"read\">\n              {tct('[read] access to [resources] resources', {\n                read: <strong>Read</strong>,\n                resources: permissions.read.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n        {permissions.write.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"write\">\n              {tct('[read] and [write] access to [resources] resources', {\n                read: <strong>Read</strong>,\n                write: <strong>Write</strong>,\n                resources: permissions.write.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n        {permissions.admin.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"admin\">\n              {tct('[admin] access to [resources] resources', {\n                admin: <strong>Admin</strong>,\n                resources: permissions.admin.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n      </PermissionWrapper>\n    );\n  }\n\n  renderTopButton(disabledFromFeatures: boolean, userHasAccess: boolean) {\n    const install = this.install;\n    if (install) {\n      return (\n        <Confirm\n          disabled={!userHasAccess}\n          message={tct('Are you sure you want to remove the [slug] installation?', {\n            slug: this.integrationSlug,\n          })}\n          onConfirm={() => this.handleUninstall(install)} //called when the user confirms the action\n          onConfirming={this.recordUninstallClicked} //called when the confirm modal opens\n          priority=\"danger\"\n        >\n          <StyledUninstallButton size=\"small\" data-test-id=\"sentry-app-uninstall\">\n            <IconSubtract isCircled style={{marginRight: space(0.75)}} />\n            {t('Uninstall')}\n          </StyledUninstallButton>\n        </Confirm>\n      );\n    }\n\n    if (userHasAccess) {\n      return (\n        <InstallButton\n          data-test-id=\"install-button\"\n          disabled={disabledFromFeatures}\n          onClick={() => this.handleInstall()}\n          priority=\"primary\"\n          size=\"small\"\n          style={{marginLeft: space(1)}}\n        >\n          {t('Accept & Install')}\n        </InstallButton>\n      );\n    }\n\n    return this.renderRequestIntegrationButton();\n  }\n\n  //no configurations for sentry apps\n  renderConfigurations() {\n    return null;\n  }\n}\n\nconst Text = styled('p')`\n  margin: 0px 6px;\n`;\n\nconst Permission = styled('div')`\n  display: flex;\n`;\n\nconst PermissionWrapper = styled('div')`\n  padding-bottom: ${space(2)};\n`;\n\nconst Title = styled('p')`\n  margin-bottom: ${space(1)};\n  font-weight: bold;\n`;\n\nconst Indicator = styled(p => <CircleIndicator size={7} {...p} />)`\n  margin-top: 3px;\n  color: ${p => p.theme.success};\n`;\n\nconst InstallButton = styled(Button)`\n  margin-left: ${space(1)};\n`;\n\nconst StyledUninstallButton = styled(Button)`\n  color: ${p => p.theme.gray300};\n  background: ${p => p.theme.background};\n\n  border: ${p => `1px solid ${p.theme.gray300}`};\n  box-sizing: border-box;\n  box-shadow: 0px 2px 1px rgba(0, 0, 0, 0.08);\n  border-radius: 4px;\n`;\n\nexport default withOrganization(SentryAppDetailedView);\n"],"sourceRoot":""}