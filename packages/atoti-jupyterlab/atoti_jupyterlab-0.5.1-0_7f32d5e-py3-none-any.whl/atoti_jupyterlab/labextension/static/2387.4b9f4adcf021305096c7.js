(self.webpackChunkatoti_jupyterlab=self.webpackChunkatoti_jupyterlab||[]).push([[2387],{12387:(e,n,o)=>{"use strict";o.r(n),o.d(n,{default:()=>H});var r=o(39030),l=o(12370),i=o(56271),a=o.n(i),t=(o(78951),o(8336)),d=(o(2689),o(96267)),s=(o(52596),o(95923)),u=o(58527),m=o.n(u),h=o(56974),c=o.n(h),p=o(18149),x=o.n(p),v=o(88665),f=o.n(v),y=o(40441),g=o(94212),I=o(95479),C=o(35129),w=o(3582),b=o(92662),E=o.n(b),S=o(10208),R=o(39349),N=o(71249),P=o(31312);const k=({parentTotalRowIndex:e,rowIndex:n})=>({backgroundColor:(n-e)%2==1?"#FAFAFA":"",borderRight:"1px solid #E9E9E9",borderTop:e===n&&n>0?"1px solid #E9E9E9":""}),A=e=>{var n;return(null===(n=e.axis)||void 0===n?void 0:n.id)===I.xy.rows?(({axis:e,columnIndex:n,hierarchyIndex:o,levelIndex:r,numberOfColumnsInRowHeader:l,numberOfRowsInColumnHeader:i,parentTotalRowIndex:a,rowIndex:t})=>{var d;if(void 0===e)return{};const s=(null==e||null===(d=e.range)||void 0===d?void 0:d.from)||0,u=(null==e?void 0:e.positions[t-s][o].captionPath[r])||"",m=null==e?void 0:e.positions[t-s-1],h=m&&m[o].captionPath[r]||"";return{backgroundColor:n===l-1&&(t-a)%2==1?"#FAFAFA":"",borderRight:n===l-1?"2px solid #E9E9E9":"",borderTop:t===a&&t>0?"1px solid #E9E9E9":"",fontWeight:n===l-1?void 0:600,...n<l-1&&""!==u&&u===h?{display:"none"}:{}}})(e):(({axis:e,columnIndex:n,hierarchyIndex:o,levelIndex:r,numberOfColumnsInRowHeader:l,numberOfRowsInColumnHeader:i,parentTotalRowIndex:a,rowIndex:t})=>{var d;if(void 0===e)return{};const s=(null==e||null===(d=e.range)||void 0===d?void 0:d.from)||0,u=(null==e?void 0:e.positions[n-s][o].captionPath[r])||"",m=null==e?void 0:e.positions[n-s-1],h=m&&m[o].captionPath[r]||"";return t<i-1&&""!==u&&u===h?{display:"none",fontWeight:600}:{fontWeight:600}})(e)},M=a().memo((e=>{var n,o,r,i;const a=(0,y.bb)(e),{formatMessage:d}=(0,R.useIntl)();if(null===a)return null;if(a.every((e=>"AllMember"===c()(e.captionPath)))&&0===e.rowIndex&&0===e.columnIndex)return(0,t.jsx)("div",{style:{fontSize:12,fontWeight:600,padding:"4px 4px 3px"}},d({id:"aui.total"}));const s=c()(a.filter((e=>"AllMember"!==c()(e.captionPath))));if(void 0===s)return null;const{cube:u,mapping:m}=e,h=s&&u&&"Measures"!==s.dimensionName?(0,C._y)(s,u):null,p=(null===(n=e.axis)||void 0===n?void 0:n.id)===I.xy.rows?m.rows:m.columns,v=s?p.find((e=>e.startsWith((0,S.mW)(null==s?void 0:s.dimensionName,null==s?void 0:s.hierarchyName)))):null,f=v?c()((0,S.I8)(v)):null,g=h&&f?h.levels.findIndex((({name:e})=>e===f)):-1,b=h?h.levels.length-2:-1,N=e.levelIndex>=g&&e.levelIndex<=b,P=e.isExpanded(a.slice(0,e.hierarchyIndex+1).map((({dimensionName:e,hierarchyName:n,namePath:o})=>({dimensionName:e,hierarchyName:n,namePath:o})))),k=(null===(o=c()(a.slice(0,e.hierarchyIndex+1)).captionPath)||void 0===o?void 0:o[e.levelIndex])||"",M=P?w.DownOutlined:E(),O=null===(r=e.sort)||void 0===r?void 0:r.orderMode,j=null===(i=e.sort)||void 0===i?void 0:i.tupleCoordinates,H=a.map((({dimensionName:e,hierarchyName:n,namePath:o})=>({dimensionName:e,hierarchyName:n,namePath:o}))),T=k===s.captionPath[e.levelIndex]&&O&&j&&x()(H,j),W=T&&"ASC"===O?l.od:T&&"DESC"===O?l._r:void 0,K={...(0,y.pB)(e),...A({axis:e.axis,columnIndex:e.columnIndex,hierarchyIndex:e.hierarchyIndex,levelIndex:e.levelIndex,numberOfColumnsInRowHeader:e.numberOfColumnsInRowHeader,numberOfRowsInColumnHeader:e.numberOfRowsInColumnHeader,parentTotalRowIndex:e.parentTotalRowIndex||0,rowIndex:e.rowIndex})};return(0,t.jsx)("div",{style:{overflow:"hidden",display:"flex",alignItems:"center",...K}},N&&""!==k?(0,t.jsx)(M,{onClick:()=>{e.onExpansionChanged(a.slice(0,e.hierarchyIndex+1),!P)},style:{cursor:"pointer",fontSize:10,marginRight:6}}):null,(0,t.jsx)("span",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",maxWidth:`calc(100% - ${N?"16px":"0px"} - ${T?"18px":"0px"} `}},k),W&&""!==k?(0,t.jsx)(W,{onClick:e.onSortChanged,style:{cursor:"pointer",marginLeft:"auto",height:"100%"}}):(0,t.jsx)("div",{style:{height:"100%",marginLeft:6}}))})),O=(e,n)=>{if((0,r.cv)(n)!==(0,r.cv)(e))return!1;if((0,r.cv)(n)&&(0,r.cv)(e)){var o,l;const{dashboardState:r,onDashboardChange:i,...a}=e,{dashboardState:t,onDashboardChange:d,...s}=n;return f()(a,s)&&r.filters===t.filters&&(null===(o=(0,P.fx)(r,e.pageKey))||void 0===o?void 0:o.filters)===(null===(l=(0,P.fx)(t,n.pageKey))||void 0===l?void 0:l.filters)}return f()(e,n)},j=e=>{(0,r.v4)(e);const{queryResult:n,onChange:o,onSelectionChange:l,widgetState:t}=e,{mdx:u}=t.query,{serverKey:h}=t,p=(0,s.kP)(h),v=(0,i.useMemo)((()=>u&&(0,S.pO)(u)),[u]),f=(0,i.useMemo)((()=>p&&v?(0,C.sR)(p,v):void 0),[p,v]),w=(0,i.useMemo)((()=>u?(0,S.KY)(u):null),[u]),b=(0,i.useMemo)((()=>u&&(0,S.r$)(u)),[u]),E=(0,i.useCallback)(((e,n)=>{const r=c()(e);if(f&&u&&r){const{dimensionName:l,hierarchyName:i}=r,a=(0,C._y)({dimensionName:l,hierarchyName:i},f),d=r.namePath.length-1;if(d<a.levels.length-1){let r=u;r=n?(0,S.jn)(u,{tupleCoordinates:e,toLevel:a.levels[d+1].name}):(0,S.wo)(u,{tupleCoordinates:e});const l=(0,N.produce)(t,(e=>{e.query.mdx=r}));o(l)}}}),[f,u,o,t]),R=(0,i.useCallback)((e=>(w||[]).some((n=>x()(n,e)))),[w]),P=(0,i.useCallback)((()=>{if(u&&f&&b){const{orderMode:e,tupleCoordinates:n}=b,r=(0,S.HD)(u,{cube:f,tupleCoordinates:n,orderMode:"ASC"===e?"DESC":"ASC"}),l=(0,N.produce)(t,(e=>{e.query.mdx=r}));o(l)}}),[f,u,o,b,t]),O=(0,i.useCallback)((e=>a().createElement(M,m()({},e,{cube:f,sort:b,isExpanded:R,onSortChanged:P,mapping:t.mapping,onExpansionChanged:E}))),[f,E,R,t.mapping,b,P]);if((0,r.TS)(t.mapping))return a().createElement(d.P,{style:e.style});if(null==n?void 0:n.error){if((0,r.Z9)(n.error,"QueryTimeoutException"))throw new I.MB(n.error);throw new I.wb(n.error)}return a().createElement(g.$j,{isLoading:null==n?void 0:n.isLoading},(null==n?void 0:n.data)&&t.serverKey&&a().createElement(y.iA,{serverKey:t.serverKey,data:null==n?void 0:n.data,getBodyCellStyle:k,getHeaderCellStyle:A,headerCellComponent:O,onSelectionChange:l,containerStyle:e.style,columnWidths:t.columnWidths}))},H=(0,i.memo)(j,O)}}]);