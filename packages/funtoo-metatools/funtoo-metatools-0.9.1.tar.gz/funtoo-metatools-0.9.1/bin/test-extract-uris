#!/usr/bin/python3

import sys

uri_strs = [
	"https://foo.bar.com/blah-1.0.tar.gz",
	"https://foo.bar.com/blah-1.0.tar.bz2 https://foo.fart.com/blegh-2.0.tar.gz",
	"https://foo.bar.com/same-1.0.tar.gz https://foo.fart.com/same-1.0.tar.gz",
]

uris_for_filedata = [
	"https://github.com/robint99/mate-dock-applet/archive/V0.87.tar.gz",
	"https://github.com/ubuntu-mate/mate-dock-applet/archive/20.04.0.tar.gz -> mate-dock-applet-20.04.0.tar.gz",
]

manifest_path = "/home/drobbins/repo_tmp/dest-trees/meta-repo/kits/mate-kit/x11-misc/mate-dock-applet/Manifest"


def main_thread():
	for uri_str in uri_strs:
		print(hub.merge.metadata.extract_uris(uri_str))
	for uri_str in uris_for_filedata:
		print("****************** TESTING", uri_str)
		result_list = hub.merge.metadata.get_filedata(uri_str, manifest_path)
		for result in result_list:
			try:
				assert "src_uri" in result
			except AssertionError:
				print(f"src_uri not in result {result}")
				print(f"Original SRC_URI was {uri_str}")
				sys.exit(1)


if __name__ == "__main__":
	hub = Hub()
	hub.add("funtoo/merge")
	main_thread()
