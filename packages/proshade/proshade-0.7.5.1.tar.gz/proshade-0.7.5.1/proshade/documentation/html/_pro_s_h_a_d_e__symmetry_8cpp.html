<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: src/proshade/ProSHADE_symmetry.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.5.1 (JAN 2021)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_pro_s_h_a_d_e__symmetry_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ProSHADE_symmetry.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This source file contains all the functions required to detect symmetry axes and types from the inverse SOFT map.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_pro_s_h_a_d_e__symmetry_8hpp_source.html">ProSHADE_symmetry.hpp</a>&quot;</code><br />
</div>
<p><a href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af62700fc94d2901ec61928d01773ea57"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">determinePeakThreshold</a> (std::vector&lt; proshade_double &gt; inArr, proshade_double noIQRsFromMedian)</td></tr>
<tr class="memdesc:af62700fc94d2901ec61928d01773ea57"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a vector of values and determines the threshold for removing noise from it.  <a href="_pro_s_h_a_d_e__symmetry_8cpp.html#af62700fc94d2901ec61928d01773ea57">More...</a><br /></td></tr>
<tr class="separator:af62700fc94d2901ec61928d01773ea57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79ed59214fd3ab2bee9021cf1c7f3431"><td class="memItemLeft" align="right" valign="top">std::pair&lt; proshade_unsign, proshade_unsign &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a79ed59214fd3ab2bee9021cf1c7f3431">findBestIcosDihedralPair</a> (std::vector&lt; proshade_double * &gt; *CSymList, proshade_double minPeakHeight, proshade_double axErr)</td></tr>
<tr class="memdesc:a79ed59214fd3ab2bee9021cf1c7f3431"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds the best pair of axes conforming to the icosahedron dihedral angle.  <a href="_pro_s_h_a_d_e__symmetry_8cpp.html#a79ed59214fd3ab2bee9021cf1c7f3431">More...</a><br /></td></tr>
<tr class="separator:a79ed59214fd3ab2bee9021cf1c7f3431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a458a09071115478efb8b666b839c18f2"><td class="memItemLeft" align="right" valign="top">std::pair&lt; proshade_unsign, proshade_unsign &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp.html#a458a09071115478efb8b666b839c18f2">findBestOctaDihedralPair</a> (std::vector&lt; proshade_double * &gt; *CSymList, proshade_double minPeakHeight, proshade_double axErr)</td></tr>
<tr class="memdesc:a458a09071115478efb8b666b839c18f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds the best pair of axes conforming to the octahedron dihedral angle.  <a href="_pro_s_h_a_d_e__symmetry_8cpp.html#a458a09071115478efb8b666b839c18f2">More...</a><br /></td></tr>
<tr class="separator:a458a09071115478efb8b666b839c18f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe2404666a504704a67e634c2abe186c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c">sortProSHADESymmetryByPeak</a> (proshade_double *a, proshade_double *b)</td></tr>
<tr class="memdesc:afe2404666a504704a67e634c2abe186c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows using std::sort to sort vectors of ProSHADE symmetry format..  <a href="_pro_s_h_a_d_e__symmetry_8cpp.html#afe2404666a504704a67e634c2abe186c">More...</a><br /></td></tr>
<tr class="separator:afe2404666a504704a67e634c2abe186c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This source file contains all the functions required to detect symmetry axes and types from the inverse SOFT map. </p>
<p>The functions in this source file are required to allow detection of symmetry axes and symmetries from the inverse SOFT map. The currect functionality can detect C, D, T, O and I symmetries with the C and D symmetries having their fold automatically detected as well.</p>
<p>Copyright by Michal Tykac and individual contributors. All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: 1) Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2) Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. 3) Neither the name of Michal Tykac nor the names of this code's contributors may be used to endorse or promote products derived from this software without specific prior written permission.</p>
<p>This software is provided by the copyright holder and contributors "as is" and any express or implied warranties, including, but not limitted to, the implied warranties of merchantibility and fitness for a particular purpose are disclaimed. In no event shall the copyright owner or the contributors be liable for any direct, indirect, incidental, special, exemplary, or consequential damages (including, but not limitted to, procurement of substitute goods or services, loss of use, data or profits, or business interuption) however caused and on any theory of liability, whether in contract, strict liability or tort (including negligence or otherwise) arising in any way out of the use of this software, even if advised of the possibility of such damage.</p>
<dl class="section author"><dt>Author</dt><dd>Michal Tykac </dd>
<dd>
Garib N. Murshudov </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.7.5.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>JAN 2021 </dd></dl>

<p class="definition">Definition in file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af62700fc94d2901ec61928d01773ea57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af62700fc94d2901ec61928d01773ea57">&#9670;&nbsp;</a></span>determinePeakThreshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double determinePeakThreshold </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; proshade_double &gt;&#160;</td>
          <td class="paramname"><em>inArr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>noIQRsFromMedian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a vector of values and determines the threshold for removing noise from it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inArr</td><td>A vector of values for which the threshold is to be determined. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>The threshold. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l00064">64</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    proshade_double ret                               = 0.0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    proshade_unsign vecSize                           = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( inArr.size() );</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    proshade_double* meadianAndIQR                    = <span class="keyword">new</span> proshade_double[2];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">//================================================ Deal with low number of input cases</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> ( vecSize == 0 ) { <span class="keyword">delete</span>[] meadianAndIQR; <span class="keywordflow">return</span> ( ret ); }                                                                   <span class="comment">// Return 0</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> ( vecSize &lt;= 4 ) { ret = std::accumulate ( inArr.begin(), inArr.end(), 0.0 ) / <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( vecSize ); }   <span class="comment">// Return mean</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//================================================ Deal with reasonable number in input cases</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment">//============================================ Allocate memory for median and IQR computation</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( meadianAndIQR, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">//============================================ Find median and IQR</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#af185ca14eb5d82fb126092767746e00a">ProSHADE_internal_maths::vectorMedianAndIQR</a>   ( &amp;inArr, meadianAndIQR );</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="comment">//============================================ Get the threshold</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        ret                                           = meadianAndIQR[0] + ( meadianAndIQR[1] * noIQRsFromMedian );</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//================================================ Sanity checks</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span> ( ret &gt; *( std::max_element ( inArr.begin(), inArr.end() ) ) )</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        ret                                           = *( std::max_element ( inArr.begin(), inArr.end() ) );</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">delete</span>[] meadianAndIQR;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a79ed59214fd3ab2bee9021cf1c7f3431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79ed59214fd3ab2bee9021cf1c7f3431">&#9670;&nbsp;</a></span>findBestIcosDihedralPair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; proshade_unsign, proshade_unsign &gt; findBestIcosDihedralPair </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>minPeakHeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>axErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finds the best pair of axes conforming to the icosahedron dihedral angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minPeakHeight</td><td>The minimum average peak height for axis to be considered. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axErr</td><td>The error tolerance on angle matching. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>The pair of axes with closest angle to the required icosahedron dihedral angle. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l02881">2881</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;{</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    std::pair&lt; proshade_unsign, proshade_unsign &gt; ret;</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    std::vector&lt; proshade_unsign  &gt; C5List;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    proshade_double bestDihedralAngle                 = 999.9;</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    </div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <span class="comment">//================================================ Find all C5 symmetries</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ ) { <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[0] == 5 &amp;&amp; CSymList-&gt;at(cSym)[5] &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C5List, cSym ); } }</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    </div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <span class="comment">//================================================ For each unique pair of C5 and C3</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign c5 = 0; c5 &lt; static_cast&lt;proshade_unsign&gt; ( C5List.size() ); c5++ )</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    {</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        {</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;            <span class="comment">//======================================== Compare only C3s to the C5List and only with decent average peak height</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[0] != 3 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[5] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;            <span class="comment">//========================================  Check the angle between the C5 and C3 axes</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(C5List.at(c5))[1],</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C5List.at(c5))[2],</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C5List.at(c5))[3],</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[1],</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[2],</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[3] );</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;            </div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;            <span class="comment">//======================================== Is the angle approximately the dihedral angle?</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;            <span class="keywordflow">if</span> ( std::abs ( std::abs( -sqrt ( 5.0 ) / 3.0 ) - std::abs( dotProduct ) ) &lt; axErr )</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;            {</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                <span class="keywordflow">if</span> ( bestDihedralAngle &gt; std::abs ( std::abs( -sqrt ( 5.0 ) / 3.0 ) - std::abs( dotProduct ) ) )</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                {</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                    bestDihedralAngle                 = std::abs ( std::abs( -sqrt ( 5.0 ) / 3.0 ) - std::abs( dotProduct ) );</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                    ret.first                         = C5List.at(c5);</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                    ret.second                        = cSym;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                }</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;            }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        }</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    }</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    </div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a458a09071115478efb8b666b839c18f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a458a09071115478efb8b666b839c18f2">&#9670;&nbsp;</a></span>findBestOctaDihedralPair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; proshade_unsign, proshade_unsign &gt; findBestOctaDihedralPair </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>CSymList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>minPeakHeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>axErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finds the best pair of axes conforming to the octahedron dihedral angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CSymList</td><td>A vector containing the already detected Cyclic symmetries. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minPeakHeight</td><td>The minimum average peak height for axis to be considered. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axErr</td><td>The error tolerance on angle matching. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>The pair of axes with closest angle to the required icosahedron dihedral angle. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03098">3098</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;{</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    std::pair&lt; proshade_unsign, proshade_unsign &gt; ret;</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    std::vector&lt; proshade_unsign  &gt; C4List;</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    proshade_double bestDihedralAngle                 = 999.9;</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    proshade_double dotProduct;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    </div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <span class="comment">//================================================ Find all C5 symmetries</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ ) { <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[0] == 4 &amp;&amp; CSymList-&gt;at(cSym)[5] &gt;= minPeakHeight ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;C4List, cSym ); } }</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    </div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="comment">//================================================ For each unique pair of C5 and C3</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign c4 = 0; c4 &lt; static_cast&lt;proshade_unsign&gt; ( C4List.size() ); c4++ )</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    {</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign cSym = 0; cSym &lt; static_cast&lt;proshade_unsign&gt; ( CSymList-&gt;size() ); cSym++ )</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;        {</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;            <span class="comment">//======================================== Compare only C3s to the C5List and only with decent average peak height</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[0] != 3 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;            <span class="keywordflow">if</span> ( CSymList-&gt;at(cSym)[5] &lt; minPeakHeight ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            </div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;            <span class="comment">//========================================  Check the angle between the C5 and C3 axes</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;            dotProduct                                = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a> ( &amp;CSymList-&gt;at(C4List.at(c4))[1],</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C4List.at(c4))[2],</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;                                                                                                     &amp;CSymList-&gt;at(C4List.at(c4))[3],</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[1],</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[2],</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                                                                                                     &amp;CSymList-&gt;at(cSym)[3] );</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;            </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;            <span class="comment">//======================================== Is the angle approximately the dihedral angle?</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;            <span class="keywordflow">if</span> ( ( ( 1.0 / sqrt ( 3.0 ) ) &gt; ( std::abs( dotProduct ) - axErr ) ) &amp;&amp; ( ( 1.0 / sqrt ( 3.0 ) ) &lt; ( std::abs( dotProduct ) + axErr ) ) )</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;            {</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;                <span class="keywordflow">if</span> ( bestDihedralAngle &gt; std::abs( ( 1.0 / sqrt ( 3.0 ) ) - std::abs( dotProduct ) ) )</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;                {</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                    bestDihedralAngle                 = std::abs( ( 1.0 / sqrt ( 3.0 ) ) - std::abs( dotProduct ) );</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                    ret.first                         = C4List.at(c4);</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                    ret.second                        = cSym;</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                }</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;            }</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        }</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    }</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    </div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe2404666a504704a67e634c2abe186c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe2404666a504704a67e634c2abe186c">&#9670;&nbsp;</a></span>sortProSHADESymmetryByPeak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sortProSHADESymmetryByPeak </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows using std::sort to sort vectors of ProSHADE symmetry format.. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Pointer to a ProSHADE symmetry formatted array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Pointer to a ProSHADE symmetry formatted array. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>Boolean whether a is larger than b. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html#l03690">3690</a> of file <a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp_source.html">ProSHADE_symmetry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;{</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    <span class="keywordflow">return</span> ( a[5] &gt; b[5] );</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160; </div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2ac3b534f974de25b092e9d48d9f7dea"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ac3b534f974de25b092e9d48d9f7dea">ProSHADE_internal_maths::computeDotProduct</a></div><div class="ttdeci">proshade_double computeDotProduct(proshade_double *x1, proshade_double *y1, proshade_double *z1, proshade_double *x2, proshade_double *y2, proshade_double *z2)</div><div class="ttdoc">Simple 3D vector dot product computation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l01701">ProSHADE_maths.cpp:1701</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00065">ProSHADE_misc.hpp:65</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_af185ca14eb5d82fb126092767746e00a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#af185ca14eb5d82fb126092767746e00a">ProSHADE_internal_maths::vectorMedianAndIQR</a></div><div class="ttdeci">void vectorMedianAndIQR(std::vector&lt; proshade_double &gt; *vec, proshade_double *&amp;ret)</div><div class="ttdoc">Function to get vector median and inter-quartile range.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00147">ProSHADE_maths.cpp:147</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a16336bdf0b391c953a549d3df115d691"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a></div><div class="ttdeci">void addToUnsignVector(std::vector&lt; proshade_unsign &gt; *vecToAddTo, proshade_unsign elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00099">ProSHADE_misc.cpp:99</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fa9be34cc2c3eb9c0decdfb277595ca7.html">proshade</a></li><li class="navelem"><a class="el" href="_pro_s_h_a_d_e__symmetry_8cpp.html">ProSHADE_symmetry.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
