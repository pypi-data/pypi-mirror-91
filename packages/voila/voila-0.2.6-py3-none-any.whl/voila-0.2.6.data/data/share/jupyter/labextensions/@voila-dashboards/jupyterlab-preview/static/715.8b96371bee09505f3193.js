(self.webpackChunk_voila_dashboards_jupyterlab_preview=self.webpackChunk_voila_dashboards_jupyterlab_preview||[]).push([[715,549],{715:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CommandIDs:()=>g,default:()=>C});var a=n(574),o=n(28),i=n(129),r=n(923),s=n(895),c=n(910),d=n(501),l=n(797),p=n(168),u=n(271);const m=new l.Token("@voila-dashboards/jupyterlab-preview:IVoilaPreviewTracker"),f="jp-MaterialIcon jp-VoilaIcon";class v extends d.DocumentWidget{constructor(e){super(Object.assign(Object.assign({},e),{content:new o.IFrame({sandbox:["allow-same-origin","allow-scripts"]})})),window.onmessage=e=>{var t,n,a,o,i;switch(null===(t=e.data)||void 0===t?void 0:t.level){case"debug":console.debug(...null===(n=e.data)||void 0===n?void 0:n.msg);break;case"info":console.info(...null===(a=e.data)||void 0===a?void 0:a.msg);break;case"warn":console.warn(...null===(o=e.data)||void 0===o?void 0:o.msg);break;case"error":console.error(...null===(i=e.data)||void 0===i?void 0:i.msg);break;default:console.log(e)}};const{getVoilaUrl:t,context:n,renderOnSave:a}=e;this.content.url=t(n.path),this.content.title.icon=f,this.renderOnSave=a,n.pathChanged.connect((()=>{this.content.url=t(n.path)}));const i=new o.ToolbarButton({iconClass:"jp-RefreshIcon",tooltip:"Reload Preview",onClick:()=>{this.reload()}}),r=o.ReactWidget.create(u.createElement("label",{className:"jp-VoilaPreview-renderOnSave"},u.createElement("input",{style:{verticalAlign:"middle"},name:"renderOnSave",type:"checkbox",defaultChecked:a,onChange:e=>{this._renderOnSave=e.target.checked}}),"Render on Save"));this.toolbar.addItem("reload",i),n&&(this.toolbar.addItem("renderOnSave",r),n.ready.then((()=>{n.fileChanged.connect((()=>{this.renderOnSave&&this.reload()}))})))}dispose(){this.isDisposed||(super.dispose(),p.Signal.clearData(this))}reload(){const e=this.content.node.querySelector("iframe");e.contentWindow&&e.contentWindow.location.reload()}get renderOnSave(){return this._renderOnSave}set renderOnSave(e){this._renderOnSave=e}}class h extends d.ABCWidgetFactory{constructor(e,t){super(t),this.getVoilaUrl=e,this.defaultRenderOnSave=!1}createNewWidget(e){return new v({context:e,getVoilaUrl:this.getVoilaUrl,renderOnSave:this.defaultRenderOnSave})}}var g;n(549),function(e){e.voilaRender="notebook:render-with-voila",e.voilaOpen="notebook:open-with-voila"}(g||(g={}));class w{constructor(e){this._commands=e}createNew(e){const t=new o.ToolbarButton({className:"voilaRender",tooltip:"Render with Voilà",iconClass:f,onClick:()=>{this._commands.execute(g.voilaRender)}});return e.toolbar.insertAfter("cellType","voilaRender",t),t}}const b={id:"@voila-dashboards/jupyterlab-preview:plugin",autoStart:!0,requires:[c.INotebookTracker],optional:[o.ICommandPalette,a.ILayoutRestorer,s.IMainMenu,i.ISettingRegistry],provides:m,activate:(e,t,n,a,i,s)=>{const c=new o.WidgetTracker({namespace:"voila-preview"});function d(n){const a=t.currentWidget;return!1!==n.activate&&a&&e.shell.activateById(a.id),a}function l(){return null!==t.currentWidget&&t.currentWidget===e.shell.currentWidget}function p(e){return`${r.PageConfig.getBaseUrl()}voila/render/${e}`}a&&a.restore(c,{command:"docmanager:open",args:e=>({path:e.context.path,factory:u.name}),name:e=>e.context.path,when:e.serviceManager.ready});const u=new h(p,{name:"Voila-preview",fileTypes:["notebook"],modelName:"notebook"});u.widgetCreated.connect(((e,t)=>{t.context.pathChanged.connect((()=>{c.save(t)})),c.add(t)}));const m=e=>{u.defaultRenderOnSave=e.get("renderOnSave").composite};s&&Promise.all([s.load(b.id),e.restored]).then((([e])=>{m(e),e.changed.connect(m)})).catch((e=>{console.error(e.message)})),e.docRegistry.addWidgetFactory(u);const{commands:f,docRegistry:v}=e;if(f.addCommand(g.voilaRender,{label:"Render Notebook with Voilà",execute:async e=>{const t=d(e);let n;t&&(n=t.context,await n.save(),f.execute("docmanager:open",{path:n.path,factory:"Voila-preview",options:{mode:"split-right"}}))},isEnabled:l}),f.addCommand(g.voilaOpen,{label:"Open with Voilà in New Browser Tab",execute:async e=>{const t=d(e);if(!t)return;await t.context.save();const n=p(t.context.path);window.open(n)},isEnabled:l}),n){const e="Notebook Operations";[g.voilaRender,g.voilaOpen].forEach((t=>{n.addItem({command:t,category:e})}))}i&&i.viewMenu.addGroup([{command:g.voilaRender},{command:g.voilaOpen}],1e3);const C=new w(f);return v.addWidgetExtension("Notebook",C),c}},C=b},760:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(645),o=n.n(a),i=n(875),r=o()((function(e){return e[1]}));r.i(i.Z),r.push([e.id,".jp-VoilaIcon {\n  background-image: var(--jp-icon-voila);\n}\n\n.jp-VoilaPreview-renderOnSave {\n  align-items: center;\n}\n",""]);const s=r},875:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var a=n(645),o=n.n(a),i=n(667),r=n.n(i),s=n(239),c=n.n(s),d=n(236),l=n.n(d),p=o()((function(e){return e[1]})),u=r()(c()),m=r()(l());p.push([e.id,'[data-jp-theme-light="true"] {\n  --jp-icon-voila: url('+u+');\n}\n\n[data-jp-theme-light="false"] {\n  --jp-icon-voila: url('+m+");\n}\n",""]);const f=p},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(a)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(o[r]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);a&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},667:e=>{"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},549:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var a=n(379),o=n.n(a),i=n(760);o()(i.Z,{insert:"head",singleton:!1});const r=i.Z.locals||{}},379:(e,t,n)=>{"use strict";var a,o=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function r(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},a=[],o=0;o<e.length;o++){var s=e[o],c=t.base?s[0]+t.base:s[0],d=n[c]||0,l="".concat(c," ").concat(d);n[c]=d+1;var p=r(l),u={css:s[1],media:s[2],sourceMap:s[3]};-1!==p?(i[p].references++,i[p].updater(u)):i.push({identifier:l,updater:v(u,t),references:1}),a.push(l)}return a}function c(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var i=n.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var r=o(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var d,l=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function p(e,t,n,a){var o=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=l(t,o);else{var i=document.createTextNode(o),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(i,r[t]):e.appendChild(i)}}function u(e,t,n){var a=n.css,o=n.media,i=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var m=null,f=0;function v(e,t){var n,a,o;if(t.singleton){var i=f++;n=m||(m=c(t)),a=p.bind(null,n,i,!1),o=p.bind(null,n,i,!0)}else n=c(t),a=u.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var o=r(n[a]);i[o].references--}for(var c=s(e,t),d=0;d<n.length;d++){var l=r(n[d]);0===i[l].references&&(i[l].updater(),i.splice(l,1))}n=c}}}},236:e=>{e.exports="data:image/svg+xml,%3Csvg xmlns:dc='http://purl.org/dc/elements/1.1/' xmlns:cc='http://creativecommons.org/ns%23' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:svg='http://www.w3.org/2000/svg' xmlns='http://www.w3.org/2000/svg' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' id='Calque_1' data-name='Calque 1' viewBox='0 0 330.005 330.005' version='1.1' sodipodi:docname='voila-dark.svg' inkscape:version='0.92.3 (2405546, 2018-03-11)' width='330.005' height='330.005'%3E %3Cmetadata id='metadata17'%3E %3Crdf:RDF%3E %3Ccc:Work rdf:about=''%3E %3Cdc:format%3Eimage/svg+xml%3C/dc:format%3E %3Cdc:type rdf:resource='http://purl.org/dc/dcmitype/StillImage' /%3E %3Cdc:title%3EBLEU-proposition-icone%3C/dc:title%3E %3C/cc:Work%3E %3C/rdf:RDF%3E %3C/metadata%3E %3Csodipodi:namedview pagecolor='%23ffffff' bordercolor='%23666666' borderopacity='1' objecttolerance='10' gridtolerance='10' guidetolerance='10' inkscape:pageopacity='0' inkscape:pageshadow='2' inkscape:window-width='2426' inkscape:window-height='1329' id='namedview15' showgrid='false' inkscape:zoom='1.888' inkscape:cx='97.210877' inkscape:cy='202.16763' inkscape:window-x='134' inkscape:window-y='55' inkscape:window-maximized='1' inkscape:current-layer='Calque_1' fit-margin-top='10' fit-margin-left='10' fit-margin-right='10' fit-margin-bottom='10' /%3E %3Cdefs id='defs4'%3E %3Cstyle id='style2'%3E.cls-1%7Bfill:%235dbcaf;%7D.cls-2%7Bfill:%23268380;%7D.cls-3%7Bfill:%23f8e14b;%7D%3C/style%3E %3C/defs%3E %3Ctitle id='title6'%3EBLEU-proposition-icone%3C/title%3E %3Cpath class='cls-2' d='m 165.005,320 c -85.47,0 -155,-69.53 -155,-155 0,-85.47 69.53,-155 155,-155 85.47,0 155,69.53 155,155 0,85.47 -69.53,155 -155,155 z m 0,-275.49 A 120.49,120.49 0 1 0 285.495,165 120.62,120.62 0 0 0 165.005,44.51 Z' id='path10' style='fill:%23bbbbbb;fill-opacity:1' inkscape:connector-curvature='0' /%3E %3Cpath class='cls-3' d='m 165.005,320 c -85.47,0 -155,-69.53 -155,-155 a 17.26,17.26 0 1 1 34.51,0 120.62,120.62 0 0 0 120.49,120.49 17.26,17.26 0 1 1 0,34.51 z' id='path12' inkscape:connector-curvature='0' style='fill:%23d97d24;fill-opacity:1' /%3E %3C/svg%3E"},239:e=>{e.exports="data:image/svg+xml,%3Csvg xmlns:dc='http://purl.org/dc/elements/1.1/' xmlns:cc='http://creativecommons.org/ns%23' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:svg='http://www.w3.org/2000/svg' xmlns='http://www.w3.org/2000/svg' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' id='Calque_1' data-name='Calque 1' viewBox='0 0 330.005 330.005' version='1.1' sodipodi:docname='voila-light.svg' inkscape:version='0.92.3 (2405546, 2018-03-11)' width='330.005' height='330.005'%3E %3Cmetadata id='metadata17'%3E %3Crdf:RDF%3E %3Ccc:Work rdf:about=''%3E %3Cdc:format%3Eimage/svg+xml%3C/dc:format%3E %3Cdc:type rdf:resource='http://purl.org/dc/dcmitype/StillImage' /%3E %3Cdc:title%3EBLEU-proposition-icone%3C/dc:title%3E %3C/cc:Work%3E %3C/rdf:RDF%3E %3C/metadata%3E %3Csodipodi:namedview pagecolor='%23ffffff' bordercolor='%23666666' borderopacity='1' objecttolerance='10' gridtolerance='10' guidetolerance='10' inkscape:pageopacity='0' inkscape:pageshadow='2' inkscape:window-width='2426' inkscape:window-height='1329' id='namedview15' showgrid='false' inkscape:zoom='1.888' inkscape:cx='-252.89506' inkscape:cy='180.98119' inkscape:window-x='134' inkscape:window-y='55' inkscape:window-maximized='1' inkscape:current-layer='Calque_1' fit-margin-top='10' fit-margin-left='10' fit-margin-right='10' fit-margin-bottom='10' /%3E %3Cdefs id='defs4'%3E %3Cstyle id='style2'%3E.cls-1%7Bfill:%235dbcaf;%7D.cls-2%7Bfill:%23268380;%7D.cls-3%7Bfill:%23f8e14b;%7D%3C/style%3E %3C/defs%3E %3Ctitle id='title6'%3EBLEU-proposition-icone%3C/title%3E %3Cpath class='cls-2' d='m 165.005,320 c -85.47,0 -155,-69.53 -155,-155 0,-85.47 69.53,-155 155,-155 85.47,0 155,69.53 155,155 0,85.47 -69.53,155 -155,155 z m 0,-275.49 A 120.49,120.49 0 1 0 285.495,165 120.62,120.62 0 0 0 165.005,44.51 Z' id='path10' style='fill:%23616161;fill-opacity:1' inkscape:connector-curvature='0' /%3E %3Cpath class='cls-3' d='m 165.005,320 c -85.47,0 -155,-69.53 -155,-155 a 17.26,17.26 0 1 1 34.51,0 120.62,120.62 0 0 0 120.49,120.49 17.26,17.26 0 1 1 0,34.51 z' id='path12' inkscape:connector-curvature='0' style='fill:%23f8e14b' /%3E %3C/svg%3E"}}]);